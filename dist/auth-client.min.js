!function(e,t){"use strict";"function"==typeof define&&define.amd?define(["angular"],t):e.hasOwnProperty("angular")?t(e.angular):"object"==typeof exports&&(module.exports=t(require("angular")))}(this,function(e){"use strict";function t(t){return function(){var n="ngStorage-";this.setKeyPrefix=function(e){if("string"!=typeof e)throw new TypeError("[ngStorage] - "+t+"Provider.setKeyPrefix() expects a String.");n=e};var r=e.toJson,o=e.fromJson;this.setSerializer=function(e){if("function"!=typeof e)throw new TypeError("[ngStorage] - "+t+"Provider.setSerializer expects a function.");r=e},this.setDeserializer=function(e){if("function"!=typeof e)throw new TypeError("[ngStorage] - "+t+"Provider.setDeserializer expects a function.");o=e},this.get=function(e){return o(window[t].getItem(n+e))},this.set=function(e,o){return window[t].setItem(n+e,r(o))},this.$get=["$rootScope","$window","$log","$timeout","$document",function(i,a,s,u,c){function l(e){var t;try{t=a[e]}catch(n){t=!1}if(t&&"localStorage"===e){var r="__"+Math.round(1e7*Math.random());try{localStorage.setItem(r,r),localStorage.removeItem(r)}catch(n){t=!1}}return t}var f,g,h=n.length,d=l(t)||(s.warn("This browser does not support Web Storage!"),{setItem:e.noop,getItem:e.noop,removeItem:e.noop}),p={$default:function(t){for(var n in t)e.isDefined(p[n])||(p[n]=e.copy(t[n]));return p.$sync(),p},$reset:function(e){for(var t in p)"$"===t[0]||delete p[t]&&d.removeItem(n+t);return p.$default(e)},$sync:function(){for(var e,t=0,r=d.length;r>t;t++)(e=d.key(t))&&n===e.slice(0,h)&&(p[e.slice(h)]=o(d.getItem(e)))},$apply:function(){var t;if(g=null,!e.equals(p,f)){t=e.copy(f),e.forEach(p,function(o,i){e.isDefined(o)&&"$"!==i[0]&&(d.setItem(n+i,r(o)),delete t[i])});for(var o in t)d.removeItem(n+o);f=e.copy(p)}}};return p.$sync(),f=e.copy(p),i.$watch(function(){g||(g=u(p.$apply,100,!1))}),a.addEventListener&&a.addEventListener("storage",function(t){if(t.key){var r=c[0];r.hasFocus&&r.hasFocus()||n!==t.key.slice(0,h)||(t.newValue?p[t.key.slice(h)]=o(t.newValue):delete p[t.key.slice(h)],f=e.copy(p),i.$apply())}}),a.addEventListener&&a.addEventListener("beforeunload",function(){p.$apply()}),p}]}}return e=e&&e.module?e:window.angular,e.module("ngStorage",[]).provider("$localStorage",t("localStorage")).provider("$sessionStorage",t("sessionStorage"))}),function(e){e.module("authClient.config",[]).value("authClient.config",{debug:!0}),e.module("authClient.services",["ngStorage"]),e.module("authClient",["authClient.config","authClient.services"])}(angular),angular.module("authClient.services").service("authenticate",["$localStorage","$http","$location","$q","$window","baseUrl",function(e,t,n,r,o,i){var a=this;this.getToken=function(){return e.jwt},this.check=function(o){return r(function(r,s){var u=a.getToken();u||(u=n.search().jwt,u&&(e.jwt=u));var c={params:{next:o},withCredentials:!1};u=a.getToken(),u&&(c.params.jwt=u),t.get(i.getBaseUrl()+"/user/check",c).then(function(t){var n=t.data;n.authenticated?r({token:u,profile:n.profile}):(delete e.jwt,s(n.providers))})})},this.login=function(e,t){o.open(e,t)},this.logout=function(){a.getToken()&&(delete e.jwt,n.search("jwt",null))}}]),angular.module("authClient.services").service("authorize",["$http","$q","baseUrl",function(e,t,n){this.check=function(r,o){return t(function(t,i){var a={params:{jwt:r,service:o},withCredentials:!1};e.get(n.getBaseUrl()+"/user/authorize",a).then(function(e){var n=e.data;t(n)},function(){i({})})})}}]),angular.module("authClient.services").service("baseUrl",function(){var e="http://next.openspending.org";this.setBaseUrl=function(t){e=t},this.getBaseUrl=function(){return e}});